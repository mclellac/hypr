#!/bin/bash
#
# Launches a floating terminal window (Alacritty) to execute a given command.
# Before the command runs, a logo is displayed. After the command finishes,
# a "Done" message is shown.

set -euo pipefail

#######################################
# Main function to launch the floating terminal.
# Globals:
#   None
# Arguments:
#   $@ - The command to be executed within the terminal.
# Outputs:
#   None
#######################################
main() {
  if [[ $# -eq 0 ]]; then
    echo "Usage: $(basename "$0") <command>" >&2
    exit 1
  fi

  # We use `setsid` to detach the new terminal.
  # We construct the bash command to run the sequence:
  # 1. hypr-show-logo
  # 2. The user's command (passed as arguments to the inner bash)
  # 3. hypr-show-done
  # We use `"$@"` to safely expand the arguments in the inner bash.

  setsid alacritty --class hypr-exec -e bash -c 'hypr-show-logo; "$@"; ret=$?; hypr-show-done; exit $ret' -- "$@"
}

main "$@"
