#!/usr/bin/env bash

# Standalone cheatsheets menu — focused on Linux, Web Security, Programming, Hacking & Tools
# Links were verified before adding. See the accompanying notes in the chat for which sources

export PATH="$HOME/.local/share/hypr/bin:$PATH"

menu() {
    local prompt="$1"
    local options="$2"
    local extra="$3"
    local preselect="$4"

    read -r -a args <<<"$extra"

    if [[ -n "$preselect" ]]; then
        local index
        index=$(echo -e "$options" | grep -nxF "$preselect" | cut -d: -f1)
        if [[ -n "$index" ]]; then
            args+=("-a" "$index")
        fi
    fi

    echo -e "$options" | walker --dmenu --theme dmenu_250 -p "$prompt…" "${args[@]}"
}

# helper to open links (keeps parity with your hypr setup)
open_web() {
    hypr-launch-webapp "$1"
}

show_linux_menu() {
    case $(menu "Linux" "Bash (Devhints)\nLinux CLI (Cheatography)\nGTFOBins\nLOLBAS\nPEASS (Privilege Escalation)\nSecLists\nBack") in
    *Bash*) open_web "https://devhints.io/bash" ;;
    *Linux\ CLI*) open_web "https://cheatography.com/davechild/cheat-sheets/linux-command-line/" ;;
    *GTFOBins*) open_web "https://gtfobins.github.io/" ;;
    *LOLBAS*) open_web "https://lolbas-project.github.io/" ;;
    *PEASS*) open_web "https://github.com/peass-ng/PEASS-ng" ;;
    *SecLists*) open_web "https://github.com/danielmiessler/SecLists" ;;
    *) show_main_menu ;;
    esac
}

show_websec_menu() {
    case $(menu "Web Security" "OWASP Top10\nOWASP Cheat Sheet Series\nHackTricks\nPayloadsAllTheThings\nPortSwigger XSS Cheat Sheet\nPortSwigger SQLi Cheat Sheet\nWeb Attack Cheat Sheet\nBack") in
    *Top10*) open_web "https://owasp.org/Top10/" ;;
    *Cheat*Series*) open_web "https://cheatsheetseries.owasp.org/index.html" ;;
    *HackTricks*) open_web "https://book.hacktricks.wiki/en/index.html" ;;
    *PayloadsAllTheThings*) open_web "https://github.com/swisskyrepo/PayloadsAllTheThings" ;;
    *PortSwigger\ XSS*) open_web "https://portswigger.net/web-security/cross-site-scripting/cheat-sheet" ;;
    *PortSwigger\ SQLi*) open_web "https://portswigger.net/web-security/sql-injection/cheat-sheet" ;;
    *Web\ Attack*) open_web "https://github.com/riramar/Web-Attack-Cheat-Sheet" ;;
    *) show_main_menu ;;
    esac
}

show_programming_menu() {
    case $(menu "Programming" "Python (gto76)\nPython Security (Bandit / Secure Coding)\nRust (cheats.rs)\nGo (Devhints)\nGTK / libadwaita Docs\nBash (Devhints)\nBack") in
    *Python*) open_web "https://github.com/gto76/python-cheatsheet" ;;
    *Python\ Security*) open_web "https://bandit.readthedocs.io/en/latest/" ;;
    *Rust*) open_web "https://cheats.rs/" ;;
    *Go*) open_web "https://devhints.io/go" ;;
    *GTK*) open_web "https://docs.gtk.org/gtk4/" ;;
    *Bash*) open_web "https://devhints.io/bash" ;;
    *) show_main_menu ;;
    esac
}

show_hacking_menu() {
    case $(menu "Hacking" "Exploit-DB\nReverse Shells\nPentest Monkey\nMetasploit (Rapid7)\nInternalAllTheThings\nWindows Privilege Escalation (WinPEAS)\nBack") in
    *Exploit-DB*) open_web "https://www.exploit-db.com/" ;;
    *Reverse\ Shells*) open_web "https://revshells.com/" ;;
    *Pentest\ Monkey*) open_web "https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" ;;
    *Metasploit*) open_web "https://github.com/rapid7/metasploit-framework" ;;
    *InternalAllTheThings*) open_web "https://swisskyrepo.github.io/InternalAllTheThings/" ;;
    *Windows\ Privilege\ Escalation*) open_web "https://github.com/carlospolop/PEASS-ng" ;;
    *) show_main_menu ;;
    esac
}

show_tools_menu() {
    case $(menu "Tools" "Nmap Cheat Sheet (HighOn.Coffee)\nSQLMap Cheat Sheet (HighOn.Coffee)\nNikto Cheat Sheet\nBurp Resources (PortSwigger)\nWireshark Cheat Sheet\nBack") in
    *Nmap*) open_web "https://highon.coffee/blog/nmap-cheat-sheet/" ;;
    *SQLMap*) open_web "https://highon.coffee/blog/sqlmap-cheat-sheet/" ;;
    *Nikto*) open_web "https://highon.coffee/blog/nikto-cheat-sheet/" ;;
    *Burp*) open_web "https://portswigger.net/burp" ;;
    *Wireshark*) open_web "https://www.wireshark.org/docs/wsug_html_chunked/" ;;
    *) show_main_menu ;;
    esac
}

show_cloud_menu() {
    case $(menu "Cloud" "AWS CLI Cheat Sheet\nAWS Well-Architected & Whitepapers\nOpenShift Docs\nTerraform Cheat Sheet (Devhints)\nBack") in
    *AWS\ CLI*) open_web "https://aws.amazon.com/cli/" ;;
    *AWS\ Well-Architected*) open_web "https://aws.amazon.com/whitepapers/" ;;
    *OpenShift*) open_web "https://docs.openshift.com/container-platform/latest/" ;;
    *Terraform*) open_web "https://devhints.io/terraform" ;;
    *) show_main_menu ;;
    esac
}

show_k8s_menu() {
    case $(menu "Kubernetes" "Kubernetes Official Docs\nKubernetes Cheatsheet (kubernetes.io)\nHelm Docs\nKubernetes Security (CIS & Best Practices)\nBack") in
    *Official*) open_web "https://kubernetes.io/docs/" ;;
    *Cheatsheet*) open_web "https://kubernetes.io/docs/reference/kubectl/cheatsheet/" ;;
    *Helm*) open_web "https://helm.sh/docs/" ;;
    *Security*) open_web "https://www.cisecurity.org/benchmark/kubernetes/" ;;
    *) show_main_menu ;;
    esac
}

show_security_docs_menu() {
    case $(menu "Security Docs" "MITRE ATT&CK\nCIS Benchmarks\nNIST Cybersecurity Framework\nBlue Team / Threat Hunting Resources\nBack") in
    *MITRE*) open_web "https://attack.mitre.org/" ;;
    *CIS*) open_web "https://www.cisecurity.org/benchmarks/" ;;
    *NIST*) open_web "https://www.nist.gov/cyberframework" ;;
    *Blue\ Team*) open_web "https://www.sans.org/" ;;
    *) show_main_menu ;;
    esac
}

show_main_menu() {
    case $(menu "Cheatsheets" "󰣇  Linux\n  Web Security\n  Programming\n󰲯  Hacking\n  Tools\n  Cloud\n󰷤  Kubernetes\n  Security Docs\nExit") in
    *Linux*) show_linux_menu ;;
    *Web*) show_websec_menu ;;
    *Programming*) show_programming_menu ;;
    *Hacking*) show_hacking_menu ;;
    *Tools*) show_tools_menu ;;
    *Cloud*) show_cloud_menu ;;
    *Kubernetes*) show_k8s_menu ;;
    *Security*) show_security_docs_menu ;;
    *Exit*) exit 0 ;;
    esac
}

# entrypoint
if [[ -n "$1" ]]; then
    case "${1,,}" in
    linux) show_linux_menu ;;
    web) show_websec_menu ;;
    prog) show_programming_menu ;;
    hack) show_hacking_menu ;;
    tools) show_tools_menu ;;
    cloud) show_cloud_menu ;;
    k8s) show_k8s_menu ;;
    security) show_security_docs_menu ;;
    *) show_main_menu ;;
    esac
else
    show_main_menu
fi
