#!/bin/bash
#
# Locks the screen using hyprlock, locks the 1Password vault, and stops any
# running screensavers to prevent interference.

set -euo pipefail

#######################################
# Main function to perform the screen locking sequence.
# Globals:
#   None
# Arguments:
#   None
# Outputs:
#   None
#######################################
main() {
  echo "Locking the screen..."
  # Start hyprlock only if it's not already running.
  pidof hyprlock || hyprlock &

  # Lock 1Password if it is running.
  if pgrep -x "1password" >/dev/null; then
    echo "Locking 1Password..."
    1password --lock &
  fi

  # Terminate any running screensaver processes.
  if pgrep -f "alacritty --class Screensaver" >/dev/null; then
    echo "Stopping screensaver..."
    pkill -f "alacritty --class Screensaver"
  fi
}

main
