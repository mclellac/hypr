#!/bin/bash
#
# Prints the most recent git tag of the local hypr repository.

set -euo pipefail

#######################################
# Main function to get and print the repository version.
# Globals:
#   HYPR_PATH - The path to the hypr git repository.
# Arguments:
#   None
# Outputs:
#   The git tag to stdout.
#######################################
main() {
  if [[ -z "${HYPR_PATH:-}" || ! -d "${HYPR_PATH}/.git" ]]; then
    echo "Error: HYPR_PATH is not set or is not a git repository." >&2
    exit 1
  fi

  git -C "${HYPR_PATH}" describe --tags "$(git -C "${HYPR_PATH}" rev-list --tags --max-count=1)"
}

main
