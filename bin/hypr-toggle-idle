#!/bin/bash
#
# Toggles the 'hypridle' service, which locks the screen when the system is idle.

set -euo pipefail

#######################################
# Main function to toggle the hypridle service.
# Globals:
#   None
# Arguments:
#   None
# Outputs:
#   None
#######################################
main() {
  if pgrep -x hypridle >/dev/null; then
    pkill -x hypridle
    notify-send "Idle Lock Disabled" "The screen will no longer lock automatically."
  else
    setsid uwsm app -- hypridle >/dev/null 2>&1 &
    notify-send "Idle Lock Enabled" "The screen will lock automatically when idle."
  fi
}

main
