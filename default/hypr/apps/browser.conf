# browser types
windowrule {
    name = tag-chromium
    match:class = ([cC]hrom(e|ium)|[bB]rave-browser|Microsoft-edge|Vivaldi-stable)
    tag = +chromium-based-browser
}

windowrule {
    name = tag-firefox
    match:class = (Firefox|zen|librewolf)
    tag = +firefox-based-browser
}

# --- Browser Popup Fixes ---
# We use match:initial_title for "Save password" and "Authentication Required" 
# These must set 'tile = off' and 'float = on' to beat the tag-based tile fix.
windowrule {
    name = browser-popups-float
    match:initial_title = ^(Save password|Password Required|Authentication Required|Confirm File Upload|Open File)$
    match:class = ([cC]hrom(e|ium)|[bB]rave-browser|Microsoft-edge|Vivaldi-stable|Firefox|zen|librewolf)
    tile = off
    float = on
    center = on
}

# Layout Fixes
# Force chromium-based browsers into a tile to deal with --app bug
windowrule {
    name = chromium-tile-fix
    match:tag = chromium-based-browser
    # We add a condition here to ensure it doesn't grab windows we want floating
    match:initial_title = !(Save password|Password Required|Authentication Required)
    tile = on
}

# Opacity Rules
windowrule {
    name = chromium-opacity
    match:tag = chromium-based-browser
    opacity = 1.0 1.0 override
}

windowrule {
    name = crx-opacity
    match:class = ^(crx_.*)$
    opacity = 1.0 1.0 override
}

windowrule {
    name = firefox-opacity
    match:tag = firefox-based-browser
    opacity = 1.0 1.0 override
}

# Video/Meeting Site Overrides
windowrule {
    name = video-site-opaque
    match:initial_title = (youtube\.com_/|app\.zoom\.us_/wc/home)
    opacity = 1.0 1.0 override
}
